# Техническое задание TicketSupport

Нужна программа для работы через api сайта по токен ключу для Адмиистраторов сервера Lineage2.
Администратор будет авторизороваться в программе (которую мы напишем) по токен ключу, который будет указываться в настройках программы. Сами настройки должны сохраняться в setting.ini
-Если ключ неверный писать где то что Ваш ключ не верный.

Нужно чтобы у него там было: 
1. Чат с общения с игроками (через тикет систему) + уведомления о новом тиките. 
- Сам тикет игрок пишет на сайте, ответы передаются через api.

2. Возможность просмотра тикетов, на которые он дал ответ. 
- В моем представлении что то на подобе qtox. справа у тебя тикеты которые были присланы.
Каким то кружочком помечать не отвеченные тикеты.

3. Возможность "закрытия тикетов". 
4. Чат между другими администраторами которые авторизованы в этой программе (что-то на подобе чата старлея), просмотр администраторов в сети. 

5. Начисление баланса за отвеченые тикеты (с использовании функции хороший/плохой ответ).
- Данная функция реализована (или будет реализована) на самом сайте. Можно только сделать вывод по окончанию что Вы были одобрены или наоборот.

6. За каждым администратором может быть закреплен свой раздел.
- В API передается id раздела. Т.Е. каждый тикет может сортироваться по категории еще. 
Некоторые администраторы могут получать тикеты со всех категорий.

По самой программе примичания:

1) Софт называется: Ticket Support
официальный адрес поекта: https://hunger-games.ws
2) Возможность свернуть софт в трей.
3) Возможность сохранять историю сообщений.
4) При получении нового сообщения звук + мигает окошко+трей

----------------------------------------------------
Данные по работе api и сайта где все это можно протестить и к чему подключать.

Сайт сейчас находится вот здесь: https://hunger-games.ghtweb.ru
для отображения сайта нужно добавить куку: hg со значением 312321
для теста лк можно использовать аккаунт 123123 - > тех поддержка

----------------------------------------------------------
Текущий token - cl123u9x8ikouuyct76x32x63txoJ
----------------------------------------------------------
----------------------------------------------------------
Ссылка для закрытия тикета
http://hunger-games.ws.main/api/tickets/<ID ТИКЕТА>/close?token=<ТОКЕН>

Обязательные $_GET поля:
token - ключ для доступа к API

----------------------------------------------------------
Ссылка на получение тикетов
https://hunger-games.ghtweb.ru/api/tickets?token=<ТОКЕН>&per-page=2&page=1

Обязательные $_GET поля:
token - ключ для доступа к API

Не обязательные $_GET поля:
per-page - Кол-во тикетов получаемых за раз
page - Страница

----------------------------------------------------------
API лишь проверяет токен и выдаёт инфу о тикетах.

----------------------------------------------------------

Ссылка на получение тикетов
https://hunger-games.ghtweb.ru/api/tickets?token=cl123u9x8ikouuyct76x32x63txoJ&per-page=2&page=1

Для работы с API необходимо передать header
(string) token
Токены лежат в таблице ghtweb_api_tokens

----------------------------------------------------------
Добавить ответ на тикет
POST https://hunger-games.ws/api/tickets/<ID тикета>/answer
(int) user_id
(string) answer

user_id берется из таблицы ghtweb_users, если модератор не зареган на сайте то необходимо это сделать!

----------------------------------------------------------


user_id берется из таблицы ghtweb_users, если модератор не зареган на сайте то необходимо это сделать!

----------------------------------------------------------


#Информация об API

 Авторизация токена
---------------------------------------------------------
GET https://hunger-games.ws/api/auth/
необходимо передавать токен в header
(string) token=<token>

Ответ
```
<user>
	<user_id>4</user_id>
	<login>ozq123456</login>
	<email>123456@123456.ru</email>
	<categories>
		<category>
			<id>1</id>
			<title>Учетная запись (аккаунт)</title>
		</category>
		<category>
			<id>3</id>
			<title>Пожертвования (донат)</title>
		</category>
		<category>
			<id>4</id>
			<title>Связь (вход в игру; задержки)</title>
		</category>
	</categories>
</user>
```

; Получение списка тикетов для переданного токена
---------------------------------------------------------
GET https://hunger-games.ws/api/tickets/
необходимо передавать токен в header
token=<token>

GET параметры
(int) per-page - 20

Ответ
```
<tickets>
	<ticket>
		<id>6</id>
		<user_id>149</user_id>
		<category_id>1</category_id>
		<priority>2</priority>
		<date_incident>2017-09-03</date_incident>
		<char_name>Bomj</char_name>
		<title>Test12</title>
		<status>1</status>
		<new_message_for_user>0</new_message_for_user>
		<new_message_for_admin>1</new_message_for_admin>
		<gs_id>1</gs_id>
		<created_at>2017-09-03 12:07:31</created_at>
		<updated_at>2017-09-03 12:07:38</updated_at>
		<gs>
			<id>1</id>
			<name>District 12</name>
		</gs>
		<category>
			<id>1</id>
			<title>Учетная запись (аккаунт)</title>
		</category>
		<answers>
			<answer>
				<id>9</id>
				<text>TestTestTestTestTestTest</text>
				<user_id>149</user_id>
				<created_at>2017-09-03 12:07:31</created_at>
			</answer>
		</answers>
		<author>
			<user_id>149</user_id>
			<login>itzqwerty123</login>
			<email>Qwerty123@mail.ru</email>
			<created_at>2017-09-03 12:06:26</created_at>
		</author>
	</ticket>
</tickets>
```


 Добавить ответ на тикет
 ---------------------------------------------------------
POST https://hunger-games.ws/api/tickets/<ID тикета>/answer
(string) answer

Ответ
OK
```
<result>OK</result>
```
FAIL
```
<error>Строка с ошибками</error>
```